window.$ = require('jquery')


$( document ).ajaxStart(function(){
	loading()
}).ajaxStop(function(){
	$('.load').empty()
})
function loading(text = 'Cargando datos'){
	if($('.load').children().length == 0){
		$('.load').append(
			`<div class='load-animation'>
				<div class='align-center loading'>
					<img src='/img/load.gif' alt='${text}' style='width: 100px'>
					<h4>${text}</h4>
				</div>
			</div>`
		)
	}
}
$(document).on('click', '.open-modal', function(e){
	e.preventDefault()
	$('body').addClass('overflow')
	$('#modal').removeClass('hidden').load($(this).attr('href'))
})
$(document).on('click', '.open-close', function(e){
	e.preventDefault()
	$('body').removeClass('overflow')
	$('#modal').addClass('hidden').empty()
})
$(document).on('click', '.price-format', function(event){
	$(this).val($(this).attr('data-value'))
	$(this).select()
})
$(document).on('focusout', '.price-format', function(event){
	var value = $(this).val().indexOf('$') > -1 ? parseInt($(this).attr('data-value')): ($(this).val() != '' ? parseInt($(this).val()): 0)
	$(this).val(value.format(2)).attr('data-value', value)
})
$(document).on('keypress', '.only-number', function(e){
	if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {
		return false
	}
})
$(document).on('keypress', '.only-number-float', function(event){
	if ((event.which != 46 || $(this).val().indexOf('.') != -1) && (event.which < 48 || event.which > 57)) {
		event.preventDefault()
	}
})
$(document).on('submit', 'form', function(event){
	var _this_ = $(this)
	$.each(_this_.find('.price-format'), function(){
		$(this).val($(this).attr('data-value'))
	})
})
Number.prototype.format = function(n, x) {
	var re = '\\d(?=(\\d{' + (x || 3) + '})+' + (n > 0 ? '\\.' : '$') + ')'
	return '$ '+this.toFixed(Math.max(0, ~~n)).replace(new RegExp(re, 'g'), '$&,')
}